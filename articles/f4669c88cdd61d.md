---
title: "Next.js x Vercel で fetch のキャッシュが効かなかった"
emoji: "📝"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ['Next.js', 'Vercel', 'fetch', 'キャッシュ']
published: true
---

# Next.js x Vercel で fetch のキャッシュが効かなかった問題

## ローカルでは動作したのに、Vercelでは効かない

Next.jsをローカル環境で実行した際には、`force-cache`オプションが正常に機能していました。しかし、同じコードをVercelにデプロイすると、突然キャッシュが効かなくなるという問題に直面しました。

## 原因はNext.jsのバージョン

調査の結果、この問題はNext.jsの特定のバージョンに起因していることが判明しました。具体的には、バージョン14.2.0から14.2.2の間に存在するバグが原因でした。

[問題提起のissue](https://github.com/vercel/next.js/pull/64799)

## 解決策：バージョンアップグレード

この問題は、Next.jsを14.2.3以上にアップグレードすることで解決しました。バージョンアップ後、Vercel環境でも`force-cache`オプションが期待通りに機能するようになりました。

常に最新のバージョンを使用することで、このような予期せぬ問題を回避できる可能性が高くなります。Next.jsのアップデート情報には常に注意を払い、定期的なバージョンアップを行うことをお勧めします。
